---
title: "Emory COVID-19 Response Collaborative"
subtitle: "Data visualization with ggplot2: an overview and demonstration"
author: '[EpiRhandbook Team](https:://epirhandbook.com) <br><br> `r icons::icon_style(icons::fontawesome("twitter"), fill = "white")` [epiRhandbook](https://twitter.com/epiRhandbook) <br> `r icons::icon_style(icons::fontawesome("paper-plane"), fill = "white")` [epirhandbook@gmail.com](mailto:epirhandbook@gmail.com)'
date: "August 2021"
output:
  xaringan::moon_reader:
    seal: TRUE
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
    css: xaringan-themer.css
---

```{r, echo=F}
# You need to run this line once, for the slides to render 
# icons::download_fontawesome()

```


```{css, echo = F}
/* THIS IS A CSS CHUNK - THIS IS A COMMENT */

/* Size of font in code echo. E.g. 10px or 50% */
.remark-code {
  font-size: 70%;
}


/* Size of font in text */

.medium-text {
  font-size: 75%;     
}

/* Size of font in tables */

.small-table table {
  font-size: 6px;     
}

.medium-table table {
  font-size: 8px;     
}

.medium-large-table table {
  font-size: 10px;     
}

```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      warning = FALSE, 
                      message = FALSE, 
                      fig.retina = 3  ## retina more effective than w/h (according to twitter)
                      # fig.width = 16, 
                      # fig.height = 10
                      )

## I dont know why this is included in the example xaringan slide 
## but is something to do with background images
options(htmltools.dir.version = FALSE)
```


```{r}
## install and load necessary packages 
pacman::p_load(
  rio,        # importing data  
  here,       # relative file pathways  
  skimr,      # review data
  janitor,    # data cleaning and tables
  lubridate,  # working with dates
  tidyverse,  # data management and visualization
  xaringanthemer  # for styling presentation 
)

```


```{r xaringan-themer, include = FALSE}

## define presentation colours (theme) using {xaringanthemer} package 
## https://pkg.garrickadenbuie.com/xaringanthemer/articles/xaringanthemer.html

## epirhandbook logo colours: 
  ## blue: "#00538c"
  ## green: "#007732"
  ## lighter green: "#48a878"

## see ?style_mono_accent for all the things can customise
style_mono_accent(
  base_color = "#00538c", 
  link_color = "#48a878", 
  ## add logo to the title page (bit bigger)
  title_slide_background_image = "https://github.com/appliedepi/epiRhandbook_eng/raw/master/images/epiRhandbook_HexSticker_500x500.png", 
  title_slide_background_position = "100% 100%", 
  title_slide_background_size = "25%", 
  ## add logo to all following slides
  background_image = "https://github.com/appliedepi/epiRhandbook_eng/raw/master/images/epiRhandbook_HexSticker_500x500.png", 
  background_size = "10%",
  background_position = "100% 0%"
)

```


# About us  

## R support for applied epis  

![](https://github.com/appliedepi/epiRhandbook_eng/raw/master/images/Epi%20R%20Handbook%20Banner%20Beige%201500x500.png)

* We are a grassroots collaborative of applied epidemiologists  
* The (free) Epi R Handbook has been used by 40,000 people worldwide
* Now we offer customized training to health departments and NGOs  


*Bookmark www.epiRhandbook.com*  


???
- What makes us different is that we focus on the challenges of applied epi, not academic epi. We emphasize the skills used every day by ground-level epidemiologists. 





---
# Today's session   

Today is primarily *explanation* and *demonstration*, following from the previous [demonstration on data management and workflow](https://appliedepi.github.io/emory_training/presentation/slides.html).  

We assume you have reviewed the Handbook pages on [R Basics](https://epirhandbook.com/r-basics.html) and [ggplot basics](https://epirhandbook.com/ggplot-basics.html).  

![](https://github.com/appliedepi/emory_training/blob/master/presentation/images/EDGE.png?raw=true)  




???
- The learning process can be summarised into this acronym "EDGE". Today's session is primarily a *demonstration* with question & answer session. We assume that you have read at least some of the relevant pages in the Epi R Handbook prior to this session. We also offer trainings in which we guide you through case studies with hands-on coaching. 


---
# Outline

1) Setting the scene (directory, packages, data import)  
2) Fundamentals of ggplot  
3) Bar charts  
4) Epidemic curves  
5) Demographic pyramids  
6) Scatter plots  
7) Plot captions  

The Epi R Handbook contains more examples and more complex plots, for your personal reading  







---
# Visualization options in R  

Today we focus on **ggplot2** because:  

* It is good for fast data exploration of multi-dimensional data  
* It produces very high quality final outputs  
* Is accompanied by many packages that expand functionality  
* Has well-structured grammar = consistency  

Other plotting options include **base** R, **lattice**, and **plotly**  










---
# Setting the scene - directory structure  

Our R work is conducted within a dedicated directory that contains:  

* An R project (optional but advised)  
* Rmarkdown script(s)  
* A data folder  

```{r, echo = F}
fs::dir_tree(path = here::here("case_study"), recurse = TRUE)
```








---
# Load packages  

**ggplot2** is included within the **tidyverse** mega-package (read more [here](https://www.tidyverse.org/)).  

```{r, eval = FALSE, echo=TRUE}
pacman::p_load(
  rio,            # import/export
  here,           # file locator
  rmarkdown,      # reports
  lubridate,      # working with dates
  tidyverse       # mega-package for data management and visualization
  )
```

The **tidyverse** also includes these packages:  
* **dplyr** (data management)  
* **stringr** (characters and text)  
* **forcats** (factors / ordered categories)  
* and many others...  








---

class: remark-code

# Import data

We use a *clean* dataset, to focus on visualization techniques.  

* Use `import()` from **rio** to import an RDS file  
* Use `here()` from **here** to locate the file relative to the R project root

```{r echo=FALSE, eval=TRUE}
# This actually runs but is not displayed
linelist_raw <- rio::import(here::here("case_study", "data", "covid_example_data", "covid_example_data.xlsx"))
```

```{r echo=TRUE, eval=FALSE}
linelist_raw <- import(here("case_study", "data", "covid_example_data", "covid_example_data.xlsx"))
```

*Note: The `import()` function can import almost any kind of file. A .rds file stores an R data frame and retains column classes*  



---

class: remark-code

# Clean data  

Below is the code we use to clean the data. We will not linger here today, but it is available for you to review later.  

```{r, echo=T}
linelist <- linelist_raw %>% 
  filter(confirmed_case == "Yes") %>% 
  
  select(                                       # use select() to retain columns
    date_report  = reprt_creationdt_FALSE,      # (it can also be used to re-name)
    date_dob     = case_dob_FALSE,              # NEW name = OLD name
    age          = case_age,                    # aligned for readability
    gender       = case_gender,
    zip          = case_zip,
    eth          = case_eth,
    Contact_id, 
    date_onset   = sym_startdt_FALSE,
    sym_fever,
    sym_cough,
    sym_headache,
    sym_losstastesmell,
    sym_sorethroat,
    sym_myalgia,
    contact_hh        = contact_household,
    hospitalized,
    date_hospitalized = hosp_admidt_FALSE,
    date_discharge    = hosp_dischdt_FALSE,
    died,
    died_covid,
    date_died         = died_dt_FALSE,
    lat               = latitude_JITT,
    lon               = longitude_JITT) %>% 
  
  # convert column classes
  mutate(age = as.numeric(age)) %>%             # convert class
  mutate(zip = as_factor(zip)) %>% 
  mutate(across(contains("date"), ymd)) %>%     # convert all date columns, ymd() from lubridate

  # clean died column
  mutate(
    died = fct_explicit_na(died, na_level = "Unknown"),
    died = fct_relevel(died, "Yes", "No", "Unknown")
    ) %>% 
  
  # remove onset dates prior to 2020
  mutate(across(
    .cols = c(date_report, date_onset, date_hospitalized, date_discharge, date_died),
    .fns  = ~ replace(.x, .x < as.Date("2020-01-01"), NA)
    ))%>% 
  
  # Remove dates after today from all date columns
  mutate(across(
    .cols = contains("date"),
    .fns  =  ~ replace(.x, .x > Sys.Date(), NA)
    )) %>% 
  
  # delay onset to hospitalization
  mutate(
    days_onset_hosp = as.numeric(date_hospitalized - date_onset),
    days_onset_hosp = replace(days_onset_hosp, days_onset_hosp < 0, NA),
    days_onset_hosp = replace(days_onset_hosp, days_onset_hosp > 30, NA)
    ) %>% 

  # length hospitalization
  mutate(
    date_outcome = coalesce(date_died, date_discharge),
    days_hosp = as.numeric(date_outcome - date_hospitalized),
    days_hosp = replace(days_hosp, days_hosp < 0, NA),
    days_hosp = replace(days_hosp, days_hosp > 60, NA)
    )

```





---

class: small-table

# Review data  


```{r, echo=T}
# You can use `skim()` from the skimr package.  
skim(linelist) %>% 
  filter(skim_type == "character")
```

---

class: small-table

# Review data  

```{r, echo=T}
skimr::skim(linelist) %>% 
  filter(skim_type == "Date")
```


---

class: small-table

# Review data  

```{r, echo=T}
skimr::skim(linelist) %>% 
  filter(skim_type == "numeric")
```





---

class: small-table

# Review data  

Below are the first rows of the `linelist` data frame:  

```{r}
head(linelist, 25) %>% 
  DT::datatable(
    options = list(
      scrollY = 300,
      scrollX = 600,
      pageLength = 25,
      fontSize = '25%',
      dom = "ti",
      ordering = FALSE,
      rownames = FALSE,
      options = list(pageLength = 5, scrollX=T),
      class = 'white-space: nowrap' 
    )
  )

  #knitr::kable(format = 'html')
```





---
# Fundamentals of ggplot2





---
# gg-what??  

- The **ggplot2** *package* is the most popular data visualization tool in R  
- Its `ggplot()` *function* is at the core of the package  
- This whole approach is colloquially known as “ggploting”  
- Resulting figures are sometimes affectionately called “ggplots”  

**ggplot2** benefits from a wide variety of supplementary R packages that extends its functionalities, such as **gganimate**, **ggthemr**, **ggdendro**, **gghighlight**, **ggforce**...  

.footnote[
Question: What does the "gg” in these names represent?
]

???
- "gg" represents the “grammar of graphics” used to construct the figures 





---
# Syntax overview  

* “Add” plot layers and design elements on top of one another  
* Build a multi-layer plot object that can be saved, modified, printed, exported...  

--  

Order of layers will usually look like this:

1) The baseline `ggplot()` command “opens” the plot- typically the dataset is specified here  
2) Add “geom” layers that visualize data geometrically as shapes  
3) Add design elements such as axis labels, title, fonts, sizes, color schemes, legends, or axes rotation  


A simple example follows. We will explain each component.



---
# Syntax - open the plot  

.pull-left[

`ggplot()` creates an empty canvas.  
Assign the data frame `linelist`.  

```{r, echo = TRUE, eval = FALSE, tidy = FALSE}
ggplot(data = linelist)                   
```

Or alternatively use the `%>%` pipe operator to "pipe" the data frame *into* `ggplot()`  

```{r , echo = TRUE, eval = FALSE, tidy = FALSE}
linelist %>%
  ggplot()
```

]

.pull-right[

```{r , echo = FALSE, eval = TRUE, tidy = FALSE}
ggplot(data = linelist)
```
] 

???
As you can see, this is only a blank canvas, we have not defined what should be in the x and y axes, nor linked any data to be plot. It's an empty page waiting for you. This does not produce visible changes, but ggplot will now look for columns within the *linelist* dataframe.
Notes: if several data frames are needed, they can be added in their own *geoms* (example later).





---
# Syntax - Map columns to axes  

.pull-left[

Map the `x` and `y` axes to columns in the data

```{r, echo = TRUE, eval = FALSE, tidy = FALSE}
ggplot(data = linelist,
*       mapping = aes(
*         x = age,
*         y = days_hosp)
)
```

]

.pull-right[

```{r , echo = FALSE, eval = TRUE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = days_hosp))
```
] 




---
# Geoms  


.pull-left[

Data are visualized using "geom" commands, such as `geom_point()`.  

Many classical “geoms”, including:  

Geometry        |Geom                
----------------|--------------------
Histograms      |`geom_histogram()`
Points          |`geom_point()`  
Lines           |`geom_line()`  
Box plots       |`geom_boxplot()`  
Bar charts      |`geom_bar()` or `geom_col()`  
Trend lines     |`geom_smooth()`  

Full list [here](https://ggplot2.tidyverse.org/reference/)  

]


.pull-right[

```{r, message=F, warning=F}

# Histogram
histogram <- ggplot(
    data = linelist,
    mapping = aes(
      x = date_onset))+
  geom_histogram(fill = "darkorange")+
  labs(title = "geom_histogram()")+
  theme_minimal()
  

points <- ggplot(
    data = linelist,
    mapping = aes(
      x = age,       
      y = days_hosp)
    )+
  geom_point()+
  labs(title = "geom_point()")+
  theme_minimal()


smooth <- ggplot(
    data = linelist,
    mapping = aes(
      x = age,       
      y = days_onset_hosp)
    )+
  geom_smooth()+
  labs(title = "geom_smooth()")+
  theme_minimal()



density <- ggplot(
    data = linelist,
    mapping = aes(
      x = age,       
      y = days_hosp)
    )+
  geom_density2d_filled()+
  labs(title = "geom_density2d_filled()")+
  theme_minimal()

  
lines <- linelist %>% 
  group_by(eth,
           week_report = lubridate::floor_date(date_report, "week")) %>% 
  summarise(n_cases = n()) %>% 
  drop_na(week_report) %>% 
  ggplot(
    mapping = aes(
      x = week_report,       
      y = n_cases,
      color = eth),
    size = 4
    )+
  geom_line()+
  labs(title = "geom_line()")+
  theme_minimal()



boxplots <- ggplot(
    data = linelist,
    mapping = aes(
      x = died,       
      y = age)
    )+
  geom_boxplot()+
  labs(title = "geom_boxplot()")+
  theme_minimal()



violins <- ggplot(
    data = linelist,
    mapping = aes(
      x = died,       
      y = days_hosp,
      fill = died)
    )+
  geom_violin()+
  labs(title = "geom_violin()")+
  theme_minimal()


bars <- linelist %>% 
  ggplot(mapping = aes(
      y = died,
      fill = died))+
  geom_bar()+
  labs(title = "geom_bar()")+
  theme_minimal()+
  theme(legend.position = "none")


top <- cowplot::plot_grid(histogram, points,
                          boxplots, bars,
                          #smooth, density,
                          
                          nrow = 2, rel_widths = c(2,2))

cowplot::plot_grid(top, lines, ncol = 1)

```

]







---
# Syntax - "geoms"  

.pull-left[

Add a `geom_point()` command to display the data as points

```{r, echo = TRUE, eval = FALSE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = onset_hosp))
```

]

.pull-right[

```{r , echo = FALSE, eval = TRUE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = days_hosp))
```
] 










---
# Syntax - "geoms"  

.pull-left[

Add (`+`) a `geom_point()` command to display the data as points

```{r, echo = TRUE, eval = FALSE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = onset_hosp))+
*  geom_point()
```

]

.pull-right[


```{r , echo = FALSE, eval = TRUE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = days_hosp))+
  geom_point()
```
] 








---
# Syntax - mapping placement  

* If mappings are written in `ggplot()` they apply to all geoms (e.g. axes).  
* If mappings are written within a geom, they apply only to it.  

```{r, echo = TRUE, eval = FALSE, tidy = FALSE}
ggplot(                     # open the plot 
  data = linelist,            # set dataset 
* mapping = aes(              # map axes to columns
*   x = age,
*   y = days_hosp))+
  geom_point()              # plot points
```

is the same as:  

```{r, echo = TRUE, eval = FALSE, tidy = FALSE}
ggplot(data = linelist)+    # open plot and set dataset
  geom_point(               # plot points
*    mapping = aes(           # map axes to columns
*      x = age,
*      y = days_hosp))
```

(but only because there is only one geom)  


???
- Explain why you might use one or the other  






---
# Syntax - Indentations  

Indentations, spaces, and newlines do not matter for code execution, and can improve readability.  

```{r, echo = TRUE, eval = FALSE, tidy = FALSE}
ggplot(data = linelist, mapping = aes(x = age, y = days_hosp))+
  geom_point()
```

is the same as:  

```{r, echo = TRUE, eval = FALSE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = days_hosp))+
  geom_point()
```

is the same as:  

```{r, echo = TRUE, eval = FALSE, tidy = FALSE}
ggplot(
  data = linelist,
  mapping = aes(
    x = age,
    y = days_hosp))+
  geom_point()
```



???
- Explain why you might use one or the other  







---
# Syntax overview  

.pull-left[

Add additional geoms with `+`

```{r, echo = TRUE, eval = FALSE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = days_hosp))+
  geom_point()+
* geom_smooth()
```

]

.pull-right[

```{r , echo = FALSE, eval = TRUE, tidy = FALSE}
ggplot(
  data = linelist,
  mapping = aes(
    x = age,
    y = days_hosp))+
  geom_point()+
  geom_smooth()
```
] 

???
- Explain why you might use one or the other  






---

class: medium-large-table

# Syntax - other aesthetics  



.pull-left[
Aside from axes, other common "aesthetics" to specify include: 

Geometry        |Geom                
----------------|--------------------
`shape = `      |Display point as dot, star, triangle, square...
`fill =  `      |The *interior* color (e.g of bar or boxplot)  
`color = `      |The *exterior* or bar, boxplot - OR point color  
`size = `       |Line thickness, point size...
`alpha = `      |Transparency (1 = opaque, 0 = invisible)
`width = `      |Width of "bar plot" bars
`linetype = `   |Either solid, dashed, dotted, etc.  
`binwidth = `   |Width of histogram bins  
  

]


.pull-right[

```{r, message=F, warning=F}

shape_3 <- ggplot(data = linelist, aes(x = age, y = days_hosp))+
  geom_point(shape = 3)+
  theme_minimal()+
  labs(title = "shape = 3")

shape_died <- ggplot(data = linelist, aes(x = age, y = days_hosp))+
  geom_point(aes(shape = died))+
  theme_minimal()+
  labs(title = "aes(shape = died)")

###

fill_purple <- ggplot(data = linelist, aes(x = date_onset))+
  geom_histogram(fill = "purple")+
  theme_minimal()+
  labs(title = "fill = 'purple'")


fill_died <- ggplot(data = linelist, aes(x = date_onset))+
  geom_histogram(aes(fill = died))+
    theme_minimal()+
  labs(title = "aes(fill = died)")

###

col <- ggplot(data = linelist %>% count(died), aes(x = died, y = n))+
  geom_col(fill = "lightgreen", color = "purple")+
  theme_minimal()+
  labs(title = "fill = 'lightgreen', color = 'purple'")


col_died <- ggplot(data = linelist %>% count(died), aes(x = died, y = n))+
  geom_col(aes(fill = died), color = "black")+
  theme_minimal()+
  labs(title = "aes(fill = died), color = 'black'")


cowplot::plot_grid(shape_3, shape_died,
                  fill_purple, fill_died,
                   col, col_died,
                   ncol = 2, rel_widths = c(2,2))


```

]



??? 
- In ggplot terminology a plot “aesthetic” has a specific meaning. It refers to a visual property of plotted data. Note that “aesthetic” here refers to the data being plotted in geoms/shapes - not the surrounding display such as titles, axis labels, background color, that you might associate with the word “aesthetics” in common English. In ggplot those details are called “themes” and are adjusted within a theme() command









---

class: medium-text

# Syntax - other aesthetics  



.pull-left[

These aesthetics can be assigned to either:  

* Static values (`alpha = 0.3`)  
  - Assign *outside* a `mapping = aes()`  
* A data column (`aes(fill = died)`)  
  - Assign *inside* a `mapping = aes()`  

If together, a command might look like:  

```{r, echo=F, eval=F}
ggplot(data = linelist)+
  geom_point(aes(x = age, y = days_hosp, shape = died), color = "yellow")
```

This later option creates "groups" in the display of the data.  

]


.pull-right[

```{r, message=F, warning=F}

shape_3 <- ggplot(data = linelist, aes(x = age, y = days_hosp))+
  geom_point(shape = 3)+
  theme_minimal()+
  labs(title = "shape = 3")

shape_died <- ggplot(data = linelist, aes(x = age, y = days_hosp))+
  geom_point(aes(shape = died))+
  theme_minimal()+
  labs(title = "aes(shape = died)")

###

fill_purple <- ggplot(data = linelist, aes(x = date_onset))+
  geom_histogram(fill = "purple")+
  theme_minimal()+
  labs(title = "fill = 'purple'")


fill_died <- ggplot(data = linelist, aes(x = date_onset))+
  geom_histogram(aes(fill = died))+
    theme_minimal()+
  labs(title = "aes(fill = died)")

###

col <- ggplot(data = linelist %>% count(died), aes(x = died, y = n))+
  geom_col(fill = "lightgreen", color = "purple")+
  theme_minimal()+
  labs(title = "fill = 'lightgreen', color = 'purple'")


col_died <- ggplot(data = linelist %>% count(died), aes(x = died, y = n))+
  geom_col(aes(fill = died), color = "black")+
  theme_minimal()+
  labs(title = "aes(fill = died), color = 'black'")


cowplot::plot_grid(shape_3, shape_died,
                  fill_purple, fill_died,
                   col, col_died,
                   ncol = 2, rel_widths = c(2,2))


```

]







---
# Syntax - other aesthetics  

.pull-left[

Define an aesthetic value as *static* (applying to all data points) by writing it within the geom but outside the `aes()`  

```{r, echo = TRUE, eval = FALSE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = days_hosp),
*      color = "seagreen")+ # outside aes()
  geom_point()
```

]

.pull-right[

```{r , echo = FALSE, eval = TRUE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = days_hosp))+
  geom_point(color = "seagreen")

```
] 






---
# Syntax - other aesthetics   

.pull-left[

Define an aesthetic value as *dynamic* (varying for each data point) by writing it within the geom *and within the `aes()`  

```{r, echo = TRUE, eval = FALSE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = days_hosp,
*        color = died))+   # inside aes() for dynamic
  geom_point()
```

]

.pull-right[

```{r , echo = FALSE, eval = TRUE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = days_hosp,
         color = died))+   # inside aes() for dynamic
  geom_point()
```
]





---
# Syntax - other aesthetics  

.pull-left[

Another example: 

* `color` is set to vary by the value in column `died`  
* `alpha` (transparency) is set at 30% for all points  

```{r, echo = TRUE, eval = FALSE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = days_hosp,
         color = died),    # inside aes() for dynamic
*      alpha = 0.3)+       # outside aes() for static
  geom_point() 

```

Written a different (equivalent) way:  

```{r, echo = TRUE, eval = FALSE, tidy = FALSE}
ggplot(data = linelist)+
  geom_point(mapping = aes(x = age, y = days_hosp, color = died), alpha = 0.3)
```


]

.pull-right[

```{r , echo = FALSE, eval = TRUE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = days_hosp,
         color = died),    
       alpha = 0.3)+
  geom_point()        
```
]



---
# Syntax - labels  

.pull-left[

Add labels for title, axes, and legend  

```{r, echo = TRUE, eval = FALSE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = days_hosp,
         color = died),    
       alpha = 0.3)+
  geom_point()+
* labs(
*    title = "Duration of admission among hospitalized COVID-19 patients",
*    x = "Age (years)",
*    y = "Duration (days)",
*    caption = "Fictional COVID-19 data",
*    color = "Deceased"
)
```

]

.pull-right[

```{r , echo = FALSE, eval = TRUE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = days_hosp,
         color = died),    
       alpha = 0.3)+
  geom_point()+
  labs(
    title = "Duration of admission among hospitalized COVID-19 patients",
    x = "Age (years)",
    y = "Duration (days)",
    caption = "Fictional COVID-19 data",
    color = "Deceased")
```
]




---
# Syntax - theme  

.pull-left[

`theme()` adjusts non-data plot features. Pre-defined themes are easy to add.  

```{r, echo = TRUE, eval = FALSE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = days_hosp,
         color = died),    
       alpha = 0.3)+
  geom_point()+
  labs(
     title = "Duration of admission among hospitalized COVID-19 patients",
     x = "Age (years)",
     y = "Duration (days)",
     caption = "Fictional COVID-19 data",
     color = "Deceased")+
* theme_minimal(base_size = 14)
```

]

.pull-right[

```{r , echo = FALSE, eval = TRUE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = days_hosp,
         color = died),    
       alpha = 0.3)+
  geom_point()+
  labs(
    title = "Duration of admission among hospitalized COVID-19 patients",
    x = "Age (years)",
    y = "Duration (days)",
    caption = "Fictional COVID-19 data",
    color = "Deceased")+
  theme_minimal(base_size = 14)
```
]



---
# Syntax - theme  

.pull-left[

Micro-adjust with `theme()` (micro commands for each small feature)  

See the [complete list](https://ggplot2.tidyverse.org/reference/theme.html)  

```{r, echo = TRUE, eval = FALSE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = days_hosp,
         color = died),    
       alpha = 0.3)+
  geom_point()+
  labs(
     title = "Duration of admission among hospitalized COVID-19 patients",
     x = "Age (years)",
     y = "Duration (days)",
     caption = "Fictional COVID-19 data",
     color = "Deceased")+
  theme_minimal()+
* theme(legend.position = "bottom")
```

]

.pull-right[

```{r , echo = FALSE, eval = TRUE, tidy = FALSE}
ggplot(data = linelist,
       mapping = aes(
         x = age,
         y = days_hosp,
         color = died),    
       alpha = 0.3)+
  geom_point()+
  labs(
    title = "Duration of admission among hospitalized COVID-19 patients",
    x = "Age (years)",
    y = "Duration (days)",
    caption = "Fictional COVID-19 data",
    color = "Deceased")+
  theme_minimal()+
  theme(legend.position = "bottom")
```
]





---  

# Labeling  

Aggregate zip codes into number of cases and number of deaths


---  

# Final slide

